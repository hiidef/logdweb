{% extends "logdweb/base.jinja" %}
{% import "logdweb/lib.jinja" as lib %}

{% block header %}
	<h1 class="title"><a href="{{ reverse('logd-index') }}">logd admin</a></h1>
{% endblock %}

{% block sidebar %}
	<h2>logfiles</h2>
	<ul>
		{% for logfile in info['logfiles'] %}
			<li>
			{% if path and path == logfile['path'] %}
				{% if logger %}
					<a href="{{ reverse('logd-path-index', kwargs={'path':logfile['path']}) }}">{{ logfile['path'] }}</a>
				{% else %}
					{{ logfile['path'] }}
				{% endif %} ({{ logfile['length'] }})
				{% if names %}
				<ul> {% for name in names %}
					<li>
						{% if logger and name == logger %}
							{{ name }}
						{% else %}
							<a href="{{ reverse('logd-path-logger', kwargs={'path': logfile['path'], 'logger': name}) }}">{{ name }}</a>
						{% endif %}
					</li>
				{% endfor %}</ul>
				{% endif %}
			{% else %}
				<a href="{{ reverse('logd-path-index', kwargs={'path':logfile['path']}) }}">{{ logfile['path'] }}</a>
				({{ logfile['length'] }})
			{% endif %}
			</li>
		{% endfor %}
	</ul>

	<h2>stats</h2>
	<ul>
		{% for stat in stats %}
			<li><a href="{{ reverse('logd-stat-index', kwargs={'stat': stat}) }}">{{ stat }}</a>
		{% endfor %}
	</ul>

{% endblock %}

{% block main %}
	{% if path %}
		<h2>{% if level or logger or details %}<a href="{{ reverse('logd-path-index', kwargs={'path':path}) }}">{{ path }}</a>{% else %}{{ path }} [ <a href="{{ reverse('logd-path-info', kwargs={'path': path}) }}">info</a> ]{% endif %}</h2>
		<div class="search">
			<form id="search-form" action="{{ reverse('logd-path-search', kwargs={'path': path}) }}" method="GET">
				(limit: <input type="text" name="limit" maxlength="3" value="{{ limit or 50 }}" class="limit" />)
				<input type="search" name="q" value="{{ term|e }}" /> <input type="submit" class="btn" value="search" />
			</form>
		</div>
		<div class="log-container">
		{% if lines %}
			<table class="log" id="{{ path }}{% if level %}/level/{{level}}{%endif%}{%if logger %}/logger/{{logger}}{%endif%}">
				{% for line in lines %}
					{{ lib.render_line(line, path) }}
				{% endfor %}
			</table>
		{% endif %}
    </div>
	{% endif %}

	{% if details %}
		{{ lib.render_details(lines[0], path) }}
	{% endif %}

	{% if disable_update %}
	<script type="text/javascript">
		viewSettings.update = false;		
	</script>
	{% endif %}

	{{ lib.show_timers(timers) }}

{% endblock %}
